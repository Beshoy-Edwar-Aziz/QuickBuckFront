import{a as N}from"./chunk-6Q35FRCJ.js";import{a as B}from"./chunk-W7RIL5NL.js";import{a as E,b as R}from"./chunk-LEIOQS5Q.js";import"./chunk-6O6AKWEF.js";import{k as M,n as w}from"./chunk-STEM5K4J.js";import{Ab as g,Ib as d,Jb as m,Ka as h,Kb as T,Oa as l,Pa as _,Qb as j,Rb as J,eb as u,gb as p,kb as b,la as P,lb as y,nb as k,ob as I,pb as n,qb as s,rb as v,tb as C,ua as S,va as x,yb as f}from"./chunk-4IWQIHCA.js";var F=(o,a)=>a.date,z=(o,a)=>({"left-message":o,"right-message":a});function L(o,a){if(o&1){let t=C();n(0,"div",18),f("click",function(){let r=S(t).$implicit,e=g(2);return x(e.openNewChat(r.jobSeekerId,r.jobProviderId))}),n(1,"div",19),v(2,"img",20),s(),n(3,"div",21)(4,"div")(5,"p",22),d(6),s(),n(7,"p",23),d(8),s()(),n(9,"p",24),d(10),s()()()}if(o&2){let t=a.$implicit;l(2),p("src",t.jobProvider.logo,h),l(4),m(t.jobProvider.companyName),l(2),m(t==null?null:t.content),l(2),m(t==null?null:t.dateTime.split("T")[1].split(".")[0])}}function U(o,a){if(o&1&&k(0,L,11,4,"div",17,y),o&2){let t=g();I(t.TalkedToPreviously)}}function G(o,a){if(o&1){let t=C();n(0,"div",18),f("click",function(){let r=S(t).$implicit,e=g(2);return x(e.openNewChat(r.jobSeekerId,r.jobProviderId))}),n(1,"div",25),v(2,"img",20),s(),n(3,"div",21)(4,"div")(5,"p",22),d(6),s(),n(7,"p",23),d(8),s()(),n(9,"p",24),d(10),s()()()}if(o&2){let t=a.$implicit;l(2),p("src",t.jobSeeker.photo,h),l(4),m(t.jobSeeker.userName),l(2),m(t==null?null:t.content),l(2),m(t==null?null:t.dateTime.split("T")[1].split(".")[0])}}function V(o,a){if(o&1&&k(0,G,11,4,"div",17,y),o&2){let t=g();I(t.TalkedToPreviously)}}function $(o,a){if(o&1&&(v(0,"img",26),n(1,"p",27),d(2),s()),o&2){let t=g();p("src",t.JobProviderInfo==null?null:t.JobProviderInfo.logo,h),l(2),m(t.JobProviderInfo==null?null:t.JobProviderInfo.companyName)}}function A(o,a){if(o&1&&(v(0,"img",26),n(1,"p",27),d(2),s()),o&2){let t=g();p("src",t.JobSeekerInfo==null?null:t.JobSeekerInfo.photo,h),l(2),m(t.JobSeekerInfo==null?null:t.JobSeekerInfo.userName)}}function D(o,a){if(o&1&&(n(0,"div",25),v(1,"img",20),s()),o&2){let t=g().$implicit;l(),p("src",t.jobSeeker.photo,h)}}function W(o,a){if(o&1&&(n(0,"div",25),v(1,"img",20),s()),o&2){let t=g().$implicit;l(),p("src",t.jobProvider.logo,h)}}function H(o,a){if(o&1){let t=C();n(0,"li",28),f("click",function(){let r=S(t).$implicit,e=g();return x(e.getMessageById(r.id))}),n(1,"div",29),u(2,D,2,1,"div",25)(3,W,2,1),n(4,"div",30)(5,"div")(6,"p",31),d(7),s()(),n(8,"div"),d(9),s()(),n(10,"p",32),d(11),s()()()}if(o&2){let t=a.$implicit;l(2),b(2,t.userName==t.jobSeeker.userName?2:t.userName==t.jobProvider.companyName?3:-1),l(2),p("ngClass",J(5,z,t.userName==t.jobSeeker.userName,t.userName==t.jobProvider.companyName)),l(3),m(t==null?null:t.userName),l(2),T(" ",t==null?null:t.content," "),l(2),m(t==null?null:t.dateTime.split("T")[1].split(".")[0])}}function q(o,a){if(o&1&&(n(0,"div",16)(1,"div",33)(2,"div",34),v(3,"img",35),s(),n(4,"p",36),d(5),s(),n(6,"p"),d(7,"Hiring Contact"),s(),n(8,"p")(9,"a",37),d(10),s()()()()),o&2){let t=g();l(3),p("src",t.JobProviderInfo==null?null:t.JobProviderInfo.logo,h),l(2),m(t.JobProviderInfo==null?null:t.JobProviderInfo.companyName),l(5),m(t.JobProviderInfo==null?null:t.JobProviderInfo.webSite)}}var oe=(()=>{let a=class a{constructor(c,r,e){this.chatService=c,this._userService=r,this._authService=e,this.RecievedMsg="",this.json=localStorage.getItem("JobProviderId"),this.json2=localStorage.getItem("JobSeekerId"),this.jobProviderId=JSON.parse(this.json),this.jobSeekerId=JSON.parse(this.json2),this.CurrentToken=localStorage.getItem("Token"),this.Token=E(this.CurrentToken),this.TokenRole=this.Token.sub}ngAfterViewInit(){let c=localStorage.getItem("JobSeekerId");console.log(JSON.parse(c))}ngOnInit(){this._authService.CurrentJobSeeker.subscribe(e=>{e!=""&&(console.log("behavior",e),this.jobSeekerId=e)}),this._authService.CurrentJobProvider.subscribe(e=>{e!=""&&e!=null&&(this.jobProviderId=e,console.log(e))});let c=localStorage.getItem("JobSeekerId"),r=JSON.parse(c);if(console.log(this.Token),console.log(this.TokenRole),console.log(this.jobSeekerId),console.log("jobproviderid",this.jobProviderId),this.chatService.getMessages(this.jobProviderId,this.jobSeekerId).subscribe({next:e=>{console.log(e),console.log(this.jobProviderId),this.Messages=e,this.Messages.reverse()},error:e=>{console.log(e)}}),this.chatService.startConnection().subscribe({next:()=>{this.chatService.recieveMessage().subscribe({next:e=>{console.log(e),this.RecievedMsg=e,console.log(this.chatService.user),this.user=this.chatService.user;let i=document.createElement("li");i?.classList?.add("list-unstyled"),this.Messages.forEach(O=>{this.user==O.jobSeeker.userName?(i.style.backgroundColor=" #ECFDFC",i.style.textAlign="left",i.classList.add("rounded"),i.classList.add("my-2"),i.classList.add("p-3"),i.classList.add("w-50"),i.classList.add("Generated")):(i.style.backgroundColor="#F2F2F2",i.style.textAlign="right",i.classList.add("rounded"),i.classList.add("my-2"),i.classList.add("p-3"),i.classList.add("w-50"),i.classList.add("Generated")),i.innerHTML=`${this.RecievedMsg}`,document.getElementById("MessageWindow")?.appendChild(i)})},error:e=>{console.log(e)}})},error:e=>{console.log(e)}}),this.TokenRole=="JobSeeker")this._userService.GetJobSeekerByUserName(this.Token.name).subscribe({next:e=>{console.log(e),this._userService.GetJobSeekerById(this.jobSeekerId).subscribe({next:i=>{this.jobSeekerId=i.id,console.log(this.chatService.jobSeekerId)}})}}),this._userService.GetJobProviderByIdOrByUserName(this.jobProviderId,"").subscribe({next:e=>{this.JobProviderInfo=e,console.log(e)}}),this.chatService.getMessagesByJobSeekerId(this.jobSeekerId,"").subscribe({next:e=>{console.log(e),this.TalkedToPreviously=e},error:e=>{console.log(e)}});else if(this.TokenRole=="JobProvider"){this._userService.GetJobProviderByIdOrByUserName("",this._authService.Token.name).subscribe({next:i=>{console.log(i),this.jobProviderId=i.id}});let e=localStorage.getItem("JobSeekerId");this.jobSeekerId=JSON.parse(e),this._userService.GetJobSeekerById(this.jobSeekerId).subscribe({next:i=>{this.JobSeekerInfo=i}}),this.chatService.getMessagesByJobSeekerId(0,this.jobProviderId).subscribe({next:i=>{console.log(i),this.TalkedToPreviously=i},error:i=>{console.log(i)}})}}sendMessage(c,r){let e=document.getElementById("msg");console.log(e.value),console.log(this.TokenRole),this.chatService.sendMessage(e.value,r,c,this.TokenRole,this.Token.name)}getMessageById(c){this.chatService.getMessageById(c).subscribe({next:r=>{console.log(r)},error:r=>{console.log(r)}})}openNewChat(c,r){this.TokenRole=="JobSeeker"?(this.removesMessages(),this.chatService.getMessages(r,this.jobSeekerId).subscribe({next:e=>{console.log(e),e.reverse(),this.Messages=e,this.jobProviderId=r,this._userService.GetJobProviderByIdOrByUserName(r,"").subscribe({next:i=>{this.JobProviderInfo=i}}),console.log(this.JobProviderInfo),this.chatService.getMessages(this.jobProviderId,this.jobSeekerId).subscribe({next:i=>{console.log(i),i.reverse(),this.Messages=i}})}})):(this.removesMessages(),this.chatService.getMessages(this.jobProviderId,c).subscribe({next:e=>{console.log(e),e.reverse(),this.Messages=e,this.jobSeekerId=c,this._userService.GetJobSeekerById(c).subscribe({next:i=>{this.JobSeekerInfo=i}}),this.chatService.getMessages(this.jobProviderId,this.jobSeekerId).subscribe({next:i=>{console.log(i),i.reverse(),this.Messages=i}})}}))}removesMessages(){let c=document.querySelectorAll("#MessageWindow .Generated");c.forEach(r=>{r.remove()}),console.log(c)}};a.\u0275fac=function(r){return new(r||a)(_(N),_(B),_(R))},a.\u0275cmp=P({type:a,selectors:[["app-chat-room"]],standalone:!0,features:[j],decls:25,vars:3,consts:[[1,"container"],[1,"row"],[1,"col-4"],[1,"font-lato","font-size-14"],[1,"col-6"],[1,"border","px-3"],[1,"d-flex","align-items-center","justify-content-between","p-2"],[1,"col-md-6","text-center"],[1,"d-flex","align-items-center","gap-2"],[1,"fas","fa-phone","font-size-24"],[1,"border","px-5","position-relative"],["id","MessageWindow",1,"text-decoration-none","list-unstyled"],[1,"my-2","p-2","rounded-end"],[1,"d-flex","gap-2"],["type","text","id","msg","placeholder","write message",1,"form-control","bg-body-secondary"],[1,"btn","font-lato","background-btn",3,"click"],[1,"col-md-2","justify-content-center"],[1,"d-flex","gap-2","align-items-center","list-of-conversations"],[1,"d-flex","gap-2","align-items-center","list-of-conversations",3,"click"],[1,"img-cover"],["onerror","this.src='../../../assets/Images/PlaceHolder.jpg'","alt","",1,"img-cover","rounded-circle",3,"src"],[1,"d-flex","flex-column","align-content-between"],[1,"font-lato","font-size-14","fw-bold"],[1,"font-lato","fw-light","font-size-14"],[1,"fw-light","font-lato","font-size-12"],[1,""],["alt","",1,"img-cover",3,"src"],[1,"font-lato","font-size-24","fw-bold"],[1,"my-2","p-2","rounded-end",3,"click"],[1,"d-flex","align-items-center"],[3,"ngClass"],[1,"fs-6","fw-medium"],[1,"font-lato","font-size-14","fw-normal"],[1,"d-flex","flex-column","align-items-center","justify-content-center","border-bottom"],[1,"my-2"],["alt","",1,"img-cover2",3,"src"],[1,"font-lato"],["href","",1,"text-decoration-none"]],template:function(r,e){r&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),d(4,"All Messages"),s(),u(5,U,2,0)(6,V,2,0),s(),n(7,"div",4)(8,"header",5)(9,"div",1)(10,"div",6)(11,"div",7)(12,"div",8),u(13,$,3,2)(14,A,3,2),s()(),v(15,"i",9),s()()(),n(16,"div",10)(17,"ul",11),k(18,H,12,8,"li",12,F),s()(),n(20,"div",13),v(21,"input",14),n(22,"button",15),f("click",function(){return e.sendMessage(e.jobSeekerId,e.jobProviderId)}),d(23,"Send"),s()()(),u(24,q,11,3,"div",16),s()()),r&2&&(l(5),b(5,e.TokenRole=="JobSeeker"?5:e.TokenRole=="JobProvider"?6:-1),l(8),b(13,e.TokenRole=="JobSeeker"?13:e.TokenRole=="JobProvider"?14:-1),l(5),I(e.Messages),l(6),b(24,e.TokenRole=="JobSeeker"?24:-1))},dependencies:[w,M],styles:[".background-msg[_ngcontent-%COMP%]{background-color:#ecfdfc}.background-btn[_ngcontent-%COMP%]{background-color:#0ea89b;color:#fff}.img-cover[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%}.img-cover2[_ngcontent-%COMP%]{width:150px;height:150px;border-radius:50%}i[_ngcontent-%COMP%]{color:#0ea89b}.left-message[_ngcontent-%COMP%]{text-align:left;background-color:#ecfdfc;padding:10px;border-radius:5px;margin:5px;display:inline-block;max-width:70%}.right-message[_ngcontent-%COMP%]{text-align:right;background-color:#f2f2f2;padding:10px;border-radius:5px;margin:5px;display:inline-block;max-width:70%}.list-of-conversations[_ngcontent-%COMP%]{transition:background-color .5s}.list-of-conversations[_ngcontent-%COMP%]:hover{background-color:#ecfdfc80}#MessageWindow[_ngcontent-%COMP%]{height:50vh;overflow:auto}"]});let o=a;return o})();export{oe as ChatRoomComponent};
